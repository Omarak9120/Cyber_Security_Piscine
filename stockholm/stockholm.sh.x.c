#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	/home/oabdelka/42-core/piscine_cyber/ -f stockholm.sh -o stockholm 
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\013"
#define      inlo_z	3
#define      inlo	((&data[1]))
	"\056\103\275"
#define      date_z	1
#define      date	((&data[4]))
	"\152"
#define      msg1_z	65
#define      msg1	((&data[15]))
	"\071\250\041\144\157\012\023\261\351\064\364\351\272\274\165\231"
	"\103\240\062\313\337\255\166\012\050\123\376\112\262\110\203\142"
	"\051\074\076\007\133\230\050\017\242\132\305\271\312\000\005\031"
	"\076\064\220\147\345\353\146\141\144\124\300\325\265\152\206\122"
	"\175\362\355\170\337\077\011\002\033\126\124\346\155\270\153\273"
	"\335\233"
#define      rlax_z	1
#define      rlax	((&data[87]))
	"\124"
#define      pswd_z	256
#define      pswd	((&data[151]))
	"\336\053\200\222\016\233\062\170\324\333\232\071\112\244\115\374"
	"\216\201\342\373\071\116\267\026\352\146\134\374\156\125\127\115"
	"\200\327\340\217\162\023\007\107\356\241\200\071\105\315\065\323"
	"\117\030\317\210\146\206\237\121\354\374\115\133\121\244\250\146"
	"\275\363\374\045\125\043\206\313\105\354\133\015\355\341\272\103"
	"\341\010\274\071\230\045\350\122\345\204\116\076\240\263\244\136"
	"\246\241\203\374\304\011\307\011\366\042\027\344\003\322\050\345"
	"\332\344\037\162\012\010\305\360\214\024\057\055\307\323\213\155"
	"\164\016\152\071\030\061\103\017\124\132\363\130\054\033\076\006"
	"\000\135\171\012\145\076\373\362\122\052\037\031\375\253\207\162"
	"\272\361\254\322\043\357\342\167\111\325\320\165\360\016\174\361"
	"\153\365\373\320\064\366\302\207\041\342\241\037\215\050\221\107"
	"\032\075\032\076\055\374\266\166\321\206\354\302\225\151\263\000"
	"\137\257\321\223\246\224\032\307\166\273\346\004\344\170\113\377"
	"\266\145\075\343\141\364\131\063\172\106\365\020\257\251\020\016"
	"\131\342\241\377\167\274\306\355\170\255\362\134\045\075\134\333"
	"\243\231\277\004\215\031\070\010\137\056\030\016\327\051\034\060"
	"\014\276\060\203\172\367\161\363\244\143\117\311\241\253\245\104"
	"\105\145\111\323\176\201\334\335\257\365\353\207\036\010\270\053"
	"\307\350\256\102\337\040\065\203\203\204\115\044\060\363\151\322"
	"\173\210\141\356\234\150\065\212\011\265\303\117\203\371\043\322"
	"\021\362\133\170\171\372"
#define      opts_z	1
#define      opts	((&data[430]))
	"\014"
#define      shll_z	10
#define      shll	((&data[433]))
	"\272\152\137\350\310\152\150\247\360\133\144\041"
#define      xecc_z	15
#define      xecc	((&data[443]))
	"\104\075\301\334\216\027\331\041\314\165\053\252\267\204\147\173"
	"\044\217"
#define      tst2_z	19
#define      tst2	((&data[462]))
	"\355\033\220\217\314\326\011\366\334\243\066\267\122\011\365\023"
	"\356\326\112\073"
#define      tst1_z	22
#define      tst1	((&data[486]))
	"\222\327\141\145\350\000\224\023\171\042\231\137\065\230\352\107"
	"\375\260\366\170\245\346\046\256\013\072\323\124"
#define      text_z	4845
#define      text	((&data[968]))
	"\273\052\064\262\101\365\373\373\140\025\062\123\221\126\343\165"
	"\260\375\143\277\333\240\121\262\002\267\233\126\167\374\043\063"
	"\046\127\345\147\115\341\143\255\367\225\001\210\354\345\376\234"
	"\342\141\134\276\002\256\160\004\145\013\132\334\007\176\020\056"
	"\325\366\226\043\327\371\320\316\217\322\127\174\267\125\031\232"
	"\266\165\130\271\043\311\275\210\325\030\145\335\226\165\013\153"
	"\153\241\216\103\233\137\021\053\062\150\247\352\276\300\205\164"
	"\065\336\055\131\247\353\342\174\003\107\132\231\275\145\005\051"
	"\007\224\155\242\364\176\316\047\347\165\021\245\066\227\032\154"
	"\165\110\305\034\063\247\231\067\357\364\321\255\131\326\327\140"
	"\153\104\003\137\303\322\206\252\110\230\120\176\057\152\352\244"
	"\263\260\301\346\130\133\036\110\117\357\365\251\305\314\012\061"
	"\021\015\220\324\340\027\176\050\260\317\246\337\072\221\204\355"
	"\102\105\324\232\241\362\343\361\341\331\232\247\246\244\330\267"
	"\262\151\213\222\200\012\272\060\331\141\020\023\363\224\000\065"
	"\332\325\320\173\307\263\154\250\214\007\120\062\253\051\352\135"
	"\222\165\360\023\177\253\104\131\014\124\155\000\351\156\066\303"
	"\103\006\077\012\272\254\263\107\264\003\172\137\054\144\275\277"
	"\332\256\322\132\131\027\263\146\153\041\146\125\217\234\031\323"
	"\243\131\335\136\006\221\245\272\225\040\032\302\205\327\201\137"
	"\206\124\272\337\153\156\106\327\217\254\055\037\111\106\362\355"
	"\237\320\113\245\141\361\140\367\021\172\272\227\122\074\366\330"
	"\220\260\267\374\036\375\324\256\252\001\315\364\107\277\342\347"
	"\220\055\215\362\036\355\351\060\150\243\307\272\337\276\222\160"
	"\157\112\154\216\110\101\074\362\102\011\347\212\311\311\162\131"
	"\367\000\113\026\355\065\106\125\330\016\020\270\315\242\050\074"
	"\354\225\312\064\327\007\047\031\021\016\244\332\330\027\064\317"
	"\027\200\346\005\265\054\133\216\073\153\106\010\015\157\105\371"
	"\005\020\056\334\027\125\366\050\144\233\003\003\056\303\335\115"
	"\270\017\141\034\201\040\130\010\312\160\016\362\040\061\034\275"
	"\243\372\327\366\230\347\105\044\011\357\201\022\113\142\340\330"
	"\130\317\110\064\001\111\204\062\357\312\043\110\075\115\350\052"
	"\135\071\113\335\114\042\275\363\245\240\212\321\134\331\263\020"
	"\173\373\225\303\343\230\264\027\340\305\270\246\316\347\107\236"
	"\233\074\040\004\276\332\170\120\370\160\151\071\357\123\053\243"
	"\321\071\237\376\006\014\043\106\016\330\155\337\365\075\364\015"
	"\174\244\320\244\277\144\015\253\331\251\312\000\145\225\306\225"
	"\147\243\243\227\120\253\216\132\064\027\153\205\370\220\076\300"
	"\301\343\232\354\372\205\365\071\055\102\134\237\050\116\153\073"
	"\142\020\232\361\231\206\132\212\334\151\176\252\052\245\223\231"
	"\230\107\210\211\100\072\137\352\015\357\305\226\157\343\140\334"
	"\037\237\022\377\147\031\060\226\244\237\207\276\067\124\360\242"
	"\355\377\320\066\273\217\103\346\264\047\144\174\217\147\263\355"
	"\260\352\157\131\275\240\142\155\356\202\265\372\361\367\347\142"
	"\163\216\131\214\376\217\102\212\274\061\226\025\122\266\077\133"
	"\006\324\100\255\245\262\147\211\337\371\177\312\014\336\007\021"
	"\237\137\027\302\005\266\302\371\013\124\356\007\140\211\265\115"
	"\245\362\104\070\350\101\112\343\207\274\204\033\176\345\356\227"
	"\164\336\131\146\202\360\074\254\337\071\022\020\154\014\162\016"
	"\374\031\312\241\112\310\130\301\237\030\310\353\247\243\201\004"
	"\024\230\362\145\276\157\154\141\374\074\332\155\233\000\257\335"
	"\343\330\107\270\000\263\346\120\237\210\346\201\175\122\046\221"
	"\173\161\342\002\035\112\125\041\164\310\044\203\073\033\111\037"
	"\032\126\260\360\170\372\325\142\363\210\171\074\157\360\346\162"
	"\201\065\147\210\057\131\261\227\212\253\143\101\224\212\371\005"
	"\250\047\247\206\267\361\157\040\122\306\320\133\041\257\161\166"
	"\272\176\365\065\244\032\166\102\233\021\233\366\326\320\351\076"
	"\366\033\131\326\022\203\353\027\376\002\041\243\045\361\156\177"
	"\007\212\262\124\211\216\266\207\212\241\063\006\371\140\073\255"
	"\151\103\143\102\330\374\251\066\126\336\175\273\036\142\130\315"
	"\007\061\233\236\177\246\136\211\044\337\260\361\174\227\141\375"
	"\013\263\260\011\067\321\302\274\237\164\130\057\130\121\055\232"
	"\013\117\177\224\363\155\132\322\064\272\002\165\330\001\015\012"
	"\314\070\113\376\321\221\244\053\307\311\153\357\072\022\253\312"
	"\136\054\164\000\001\113\360\154\167\310\326\314\022\052\006\142"
	"\170\260\001\057\206\106\357\311\332\271\220\340\031\061\366\101"
	"\337\230\165\022\010\125\230\154\173\107\235\050\047\206\304\141"
	"\033\242\143\233\024\372\347\234\063\147\151\243\055\221\053\374"
	"\051\355\134\251\376\370\112\157\324\127\323\310\376\133\106\070"
	"\076\077\170\141\155\310\164\005\071\370\271\044\331\024\161\250"
	"\054\044\055\316\255\124\232\357\020\014\143\205\324\226\004\051"
	"\031\211\365\140\343\033\035\072\356\245\024\254\373\246\151\115"
	"\242\077\316\323\223\273\241\325\062\103\052\330\107\077\112\030"
	"\153\226\050\374\365\362\153\173\154\254\241\076\153\251\307\205"
	"\351\100\337\062\036\005\326\076\112\046\066\047\211\207\324\010"
	"\062\103\126\027\176\353\025\255\365\140\353\017\026\121\022\037"
	"\160\313\360\326\226\367\142\053\335\222\061\177\345\170\042\207"
	"\311\351\113\027\132\063\067\076\176\114\171\307\317\120\205\053"
	"\234\252\050\220\277\172\107\111\013\235\364\006\113\356\150\036"
	"\350\245\131\012\264\314\045\130\112\321\265\054\315\054\232\075"
	"\155\043\213\302\257\360\315\207\134\072\272\215\345\346\265\024"
	"\063\006\316\375\263\155\304\011\043\034\355\146\227\342\136\021"
	"\165\007\155\010\347\336\126\260\100\000\203\175\177\036\174\142"
	"\242\006\174\354\235\335\130\054\307\003\062\005\155\250\331\047"
	"\001\365\253\061\371\203\270\366\237\307\033\062\067\237\253\247"
	"\135\276\355\370\173\034\322\140\274\155\136\234\306\163\234\005"
	"\036\212\266\015\364\207\202\260\175\266\174\072\160\004\020\056"
	"\073\203\004\215\315\375\273\106\064\012\345\220\207\343\014\365"
	"\064\134\133\356\115\350\065\263\043\225\056\023\264\001\314\337"
	"\005\173\316\222\012\175\226\044\045\215\001\137\265\234\267\352"
	"\200\150\050\307\061\072\057\062\322\056\100\011\327\070\107\165"
	"\155\036\057\274\103\234\357\016\174\132\117\255\310\016\266\227"
	"\332\321\051\246\326\270\027\257\262\366\137\023\053\014\022\303"
	"\006\344\173\317\252\303\324\327\221\340\017\132\132\307\322\110"
	"\223\313\027\117\307\271\324\032\066\275\222\367\200\302\003\153"
	"\342\244\346\046\011\157\363\001\122\157\020\361\226\355\270\216"
	"\013\111\233\172\256\073\325\172\136\124\356\131\124\354\344\171"
	"\035\373\202\106\254\070\042\275\334\345\363\063\340\212\243\230"
	"\302\164\360\253\146\306\267\270\311\251\277\155\333\220\322\205"
	"\173\350\057\326\166\243\330\040\314\352\152\137\312\361\275\364"
	"\171\161\002\341\370\373\076\071\252\057\116\076\373\042\027\126"
	"\271\274\061\340\013\365\246\150\216\013\334\163\250\271\353\253"
	"\326\333\351\130\016\036\023\363\207\237\064\213\240\314\055\110"
	"\136\062\315\307\011\274\310\041\177\237\266\151\222\244\321\263"
	"\037\060\364\315\320\374\346\243\042\021\260\133\020\020\033\216"
	"\163\334\043\121\017\134\113\061\265\313\151\064\065\326\210\132"
	"\246\254\253\242\245\236\362\115\052\374\250\056\075\307\014\304"
	"\151\360\232\150\155\135\012\034\212\143\052\160\036\001\225\366"
	"\320\316\114\141\316\274\310\237\015\045\314\157\267\075\073\250"
	"\301\230\132\237\022\130\326\165\024\047\046\014\164\073\137\230"
	"\253\124\215\250\107\113\231\315\142\137\227\216\226\004\336\036"
	"\355\115\161\166\005\035\102\013\345\207\034\024\107\165\006\056"
	"\175\350\316\024\002\105\203\043\142\057\004\264\073\324\275\106"
	"\235\300\044\102\004\047\327\027\120\063\362\104\350\125\141\354"
	"\251\105\140\261\052\161\205\031\304\076\260\045\216\044\044\237"
	"\365\263\210\137\311\271\310\105\055\265\356\060\157\265\337\022"
	"\046\123\306\245\053\116\323\201\215\205\023\221\250\264\355\333"
	"\045\232\176\334\354\250\316\133\205\251\106\363\053\201\136\247"
	"\101\042\030\114\300\253\065\366\200\301\344\061\072\371\176\257"
	"\265\263\107\047\053\334\160\017\053\010\330\023\311\107\111\273"
	"\155\017\264\214\065\341\175\144\071\030\023\215\152\133\361\337"
	"\047\061\131\062\340\001\207\076\245\341\001\012\033\314\336\114"
	"\022\135\011\266\107\014\004\144\247\175\045\345\364\200\364\160"
	"\214\377\145\032\275\052\056\301\373\224\365\033\165\144\063\025"
	"\306\100\110\040\202\321\033\115\207\353\030\345\054\314\241\101"
	"\367\003\131\076\333\270\016\303\154\247\343\210\066\145\106\055"
	"\063\103\146\125\235\333\057\332\277\370\045\065\254\131\335\306"
	"\323\000\054\344\317\201\353\065\057\022\326\117\326\207\353\262"
	"\263\124\005\342\104\016\266\340\213\036\375\170\137\060\202\034"
	"\056\174\301\021\062\134\256\170\120\246\244\073\146\131\123\046"
	"\212\063\253\251\132\173\023\071\222\244\322\355\341\061\347\100"
	"\044\072\377\373\310\125\064\112\102\325\034\036\042\327\153\276"
	"\072\205\063\264\101\172\023\116\300\304\361\011\213\342\234\137"
	"\035\204\126\114\105\364\065\163\072\105\367\321\217\114\167\170"
	"\070\200\345\162\337\221\043\061\235\046\061\216\143\377\343\277"
	"\030\103\332\353\074\351\223\165\140\257\064\262\274\152\112\231"
	"\342\301\241\152\267\113\056\270\010\217\200\244\110\045\025\214"
	"\134\016\142\224\162\023\252\202\103\054\004\144\125\013\373\172"
	"\364\022\140\232\214\336\101\142\337\313\001\151\076\031\121\237"
	"\354\206\040\244\027\114\320\226\355\370\170\013\254\025\146\373"
	"\232\313\050\020\210\161\146\323\124\373\364\163\213\364\243\272"
	"\017\141\004\356\245\222\170\257\266\233\361\162\173\303\310\202"
	"\075\152\021\001\234\227\163\105\363\063\005\315\120\144\062\025"
	"\216\361\173\363\222\232\325\241\165\312\130\116\275\355\344\264"
	"\320\233\111\246\307\162\256\204\271\122\372\212\372\022\045\154"
	"\144\204\355\265\204\142\032\112\000\361\370\372\070\116\321\317"
	"\117\206\022\002\026\342\230\044\040\222\364\241\250\243\361\051"
	"\076\363\243\226\213\251\066\307\216\100\105\247\002\170\006\052"
	"\076\240\161\253\326\306\245\244\246\313\223\342\127\344\077\007"
	"\235\342\004\211\006\371\206\204\220\305\162\257\325\072\225\044"
	"\216\367\315\326\376\303\206\277\177\257\304\075\064\273\332\342"
	"\363\044\210\315\214\155\033\203\240\147\243\335\117\320\046\274"
	"\011\375\002\125\011\063\005\331\274\360\354\373\134\011\167\032"
	"\340\257\070\304\203\021\317\056\250\010\154\222\065\044\015\161"
	"\215\145\033\201\141\260\205\252\101\234\240\207\360\277\012\140"
	"\041\253\256\232\000\241\037\166\260\310\356\075\263\371\243\157"
	"\331\000\275\232\064\245\330\005\363\046\023\162\374\175\161\021"
	"\263\325\325\074\241\167\031\074\024\236\134\200\104\061\060\272"
	"\333\341\105\125\162\212\000\127\361\063\134\247\315\103\320\103"
	"\167\174\317\052\022\123\053\273\211\326\235\027\324\174\136\323"
	"\277\102\250\215\174\254\277\311\345\067\051\324\276\246\021\056"
	"\145\030\372\361\227\301\346\042\043\176\342\327\332\034\107\103"
	"\303\263\367\006\323\203\254\111\003\307\224\373\126\331\071\044"
	"\146\050\224\056\070\140\167\264\235\125\310\343\232\213\310\174"
	"\002\203\074\107\360\100\075\171\351\026\077\014\023\357\152\011"
	"\231\167\120\214\070\066\253\103\315\114\303\364\100\175\031\235"
	"\167\022\322\110\200\330\020\077\133\100\226\003\041\067\114\323"
	"\224\232\236\115\035\376\077\302\156\200\113\020\324\143\303\042"
	"\247\245\062\074\145\144\023\317\330\106\177\137\030\170\116\235"
	"\051\036\205\276\046\306\022\005\071\160\167\126\026\172\260\073"
	"\165\074\161\207\362\353\312\130\132\312\263\303\202\074\372\123"
	"\112\242\153\353\354\040\176\151\070\151\321\337\247\342\310\137"
	"\035\206\334\302\254\320\265\235\146\375\053\066\022\025\337\171"
	"\102\141\257\042\345\373\362\112\041\214\264\275\214\171\142\041"
	"\057\376\215\123\320\257\164\151\120\066\010\057\213\335\022\067"
	"\274\040\031\232\115\274\243\300\060\104\212\134\156\314\142\247"
	"\237\143\270\063\233\215\264\377\002\256\317\025\365\340\236\343"
	"\212\042\071\056\331\024\042\147\120\314\246\122\132\316\320\267"
	"\171\301\073\073\167\366\361\262\206\326\237\375\163\347\001\115"
	"\106\134\032\243\233\150\234\345\230\163\114\264\210\343\134\273"
	"\070\247\161\201\035\303\377\013\304\014\022\340\115\002\207\341"
	"\353\372\305\120\006\157\131\330\061\352\134\032\231\152\137\102"
	"\337\033\012\116\247\341\114\366\362\212\010\044\136\233\326\260"
	"\244\140\232\210\360\301\034\103\216\071\351\250\042\365\361\224"
	"\046\216\137\066\023\334\105\133\325\335\067\133\132\137\113\235"
	"\321\061\116\276\267\112\127\233\343\277\034\026\141\205\260\341"
	"\142\176\131\347\141\350\002\315\231\112\230\026\102\126\137\333"
	"\044\110\007\352\366\151\160\301\201\253\306\353\172\057\214\056"
	"\347\173\034\056\114\354\056\330\373\050\172\150\027\342\272\360"
	"\365\263\251\203\175\202\362\130\357\163\342\202\363\317\351\235"
	"\071\007\346\364\154\043\301\226\014\367\244\215\134\214\233\210"
	"\130\341\137\057\357\351\074\217\333\105\253\122\260\106\357\142"
	"\225\112\361\376\262\220\252\057\262\343\277\235\247\045\106\024"
	"\236\335\064\173\026\036\274\214\335\124\102\154\264\366\343\104"
	"\360\062\223\017\077\356\320\253\200\142\101\377\325\071\017\057"
	"\250\235\145\122\110\371\310\207\131\241\307\126\224\020\211\072"
	"\024\102\113\205\320\005\025\337\046\177\114\072\352\106\021\214"
	"\061\126\235\246\222\034\266\275\173\147\237\017\054\201\252\201"
	"\002\054\234\221\345\133\375\142\236\367\360\137\041\331\373\161"
	"\076\314\334\327\347\067\272\357\232\027\254\253\330\024\300\225"
	"\374\164\034\171\215\262\240\302\210\274\321\267\302\165\115\104"
	"\062\213\260\065\031\176\003\203\257\326\243\145\310\120\215\162"
	"\151\212\237\117\303\356\276\104\322\110\340\305\360\117\261\103"
	"\211\174\325\334\043\330\246\001\114\242\057\370\073\355\003\213"
	"\316\164\111\272\146\344\063\212\164\066\364\356\341\307\332\314"
	"\343\071\312\117\107\232\114\115\335\135\240\163\360\225\313\140"
	"\203\377\221\311\332\260\143\331\101\266\221\312\237\262\134\375"
	"\114\147\376\314\035\240\217\064\144\314\266\242\341\063\111\370"
	"\007\103\012\161\163\151\135\136\261\221\105\201\143\035\240\251"
	"\367\101\106\174\361\121\072\132\032\150\224\321\354\345\000\355"
	"\034\224\314\371\300\240\167\063\367\135\175\163\233\020\306\000"
	"\200\133\351\026\260\126\056\332\036\343\325\064\143\157\051\373"
	"\013\235\374\164\146\001\065\334\074\020\356\217\031\075\004\127"
	"\037\053\102\066\066\017\370\313\064\270\257\306\275\105\300\121"
	"\165\217\146\341\034\055\150\213\033\041\115\117\126\370\036\104"
	"\073\130\360\365\125\037\217\377\075\053\241\146\055\124\121\244"
	"\003\364\305\131\215\303\103\067\273\337\205\071\130\231\311\210"
	"\241\257\341\040\141\010\161\256\343\232\004\063\003\111\360\310"
	"\160\343\113\175\142\260\102\073\034\037\111\066\013\363\120\125"
	"\054\345\306\157\176\231\175\072\056\102\235\164\035\214\065\000"
	"\117\274\145\274\272\273\206\226\365\126\310\270\275\033\270\220"
	"\062\270\256\325\163\040\341\016\332\241\215\146\335\105\326\011"
	"\335\334\350\033\060\170\357\313\106\254\142\161\024\066\224\373"
	"\016\121\277\227\264\007\372\034\203\250\332\314\311\352\210\010"
	"\264\027\066\325\335\026\370\243\177\324\124\276\336\225\046\325"
	"\376\075\335\030\151\327\267\141\130\305\351\370\225\032\333\065"
	"\004\234\125\253\036\233\013\054\166\316\107\160\342\166\060\070"
	"\224\103\064\101\262\173\311\140\025\120\371\357\050\032\240\334"
	"\001\167\200\373\163\003\324\121\176\156\014\161\216\247\026\032"
	"\355\347\203\067\136\351\320\070\204\026\224\343\175\067\212\357"
	"\157\175\313\367\376\151\273\360\152\070\370\220\032\276\324\231"
	"\203\367\107\214\010\001\354\111\101\242\020\156\007\264\272\362"
	"\107\224\257\204\105\210\170\256\327\045\160\256\155\005\050\134"
	"\361\201\377\310\064\047\304\132\315\031\261\114\002\153\052\201"
	"\101\302\314\207\132\217\155\273\231\060\056\242\265\234\101\105"
	"\100\355\336\233\062\057\366\030\155\271\354\217\032\220\215\034"
	"\354\264\203\161\324\211\043\156\054\122\150\303\132\215\122\370"
	"\161\324\123\236\375\260\275\176\200\173\311\026\007\164\265\300"
	"\247\344\343\034\206\355\322\176\006\030\010\364\131\373\135\276"
	"\167\244\244\052\155\377\134\246\070\316\306\370\165\333\012\312"
	"\000\007\276\074\354\027\304\342\020\165\071\104\106\270\311\267"
	"\367\275\213\047\056\077\323\253\164\122\201\110\216\016\332\251"
	"\122\147\254\241\262\375\301\122\010\347\107\065\031\067\303\363"
	"\133\364\067\204\216\217\103\134\047\155\123\252\345\271\361\231"
	"\070\010\102\074\132\351\106\361\012\250\252\237\234\075\354\000"
	"\127\023\174\200\365\215\377\165\137\000\272\056\253\236\011\152"
	"\321\363\020\116\373\002\042\262\344\316\103\140\215\121\344\146"
	"\301\356\214\205\346\236\157\061\247\236\036\226\006\344\105\147"
	"\342\255\112\341\354\114\010\325\272\036\026\150\045\204\367\112"
	"\135\167\230\244\177\234\166\322\053\263\213\316\067\042\144\312"
	"\200\127\033\014\154\074\137\200\126\360\104\244\026\071\202\130"
	"\005\217\332\356\063\203\210\257\022\204\244\232\242\032\307\201"
	"\074\265\101\117\247\273\047\131\247\071\205\062\117\344\037\334"
	"\051\207\136\026\066\005\377\074\242\110\211\077\177\223\166\017"
	"\006\323\252\236\154\114\205\313\000\126\340\212\027\050\302\215"
	"\124\111\277\334\035\134\265\314\133\200\337\014\055\250\041\353"
	"\155\331\025\116\251\261\050\063\107\007\344\113\244\042\225\226"
	"\005\004\335\056\256\043\165\004\170\163\075\077\201\026\303\376"
	"\157\355\146\236\346\170\261\273\350\371\155\163\207\113\261\303"
	"\352\061\303\361\363\052\146\241\236\161\351\334\373\322\150\136"
	"\175\140\133\215\240\177\277\220\322\305\017\346\110\315\245\133"
	"\025\200\121\230\252\342\100\272\056\346\303\327\273\163\207\225"
	"\061\062\331\161\122\344\130\244\170\363\073\145\104\365\371\114"
	"\372\051\013\274\127\236\241\264\022\150\030\120\034\025\211\150"
	"\350\205\220\363\201\164\065\165\247\224\162\070\320\050\044\360"
	"\252\226\147\060\115\034\347\020\125\373\266\371\074\026\043\205"
	"\001\234\160\210\275\037\326\050\021\132\336\062\321\160\055\345"
	"\367\132\360\353\266\203\367\106\345\241\336\214\302\305\141\000"
	"\055\050\120\072\210\057\310\310\253\315\045\211\306\352\123\013"
	"\065\207\303\025\165\354\364\076\342\063\143\151\357\310\317\002"
	"\361\212\255\256\020\025\133\117\100\343\132\100\100\076\320\304"
	"\077\133\010\245\163\234\131\367\302\231\003\121\010\214\337\205"
	"\263\115\241\161\112\104\324\303\165\155\333\333\301\275\124\116"
	"\047\152\036\337\142\004\205\237\016\151\047\367\052\121\141\041"
	"\330\205\201\050\047\173\046\351\265\243\373\377\332\025\077\203"
	"\201\240\343\247\027\204\112\233\053\034\247\272\366\010\247\036"
	"\204\312\376\162\341\037\126\072\174\222\124\246\110\326\252\102"
	"\062\073\032\210\035\057\071\341\371\362\324\210\226\060\321\155"
	"\341\111\041\313\346\361\004\141\243\062\045\110\230\166\041\362"
	"\032\167\276\016\201\025\124\114\303\317\010\314\222\274\000\326"
	"\115\002\076\166\121\174\330\151\151\317\072\213\226\215\047\230"
	"\303\357\256\203\163\073\060\163\340\362\221\042\121\336\024\164"
	"\166\346\344\307\370\265\220\321\016\340\137\157\306\171\216\114"
	"\330\000\306\004\147\336\106\036\302\277\133\076\175\076\313\126"
	"\027\010\277\245\272\364\076\105\222\352\376\263\111\244\230\352"
	"\362\050\063\247\154\033\205\176\123\166\211\240\317\041\310\033"
	"\130\265\300\225\074\030\017\055\142\107\166\216\233\140\064\233"
	"\264\231\135\141\263\303\010\365\366\136\321\023\025\160\050\316"
	"\164\277\256\076\335\374\224\304\105\370\035\054\234\111\230\303"
	"\302\056\136\161\037\227\074\006\246\175\174\325\234\246\145\204"
	"\206\307\111\033\073\030\307\110\255\333\061\315\302\050\276\075"
	"\342\171\376\314\273\017\014\131\320\341\114\016\162\152\233\265"
	"\207\050\263\373\125\135\223\270\263\257\245\354\372\076\137\211"
	"\067\346\073\333\131\361\130\246\152\123\172\350\161\154\163\237"
	"\252\126\346\061\241\204\021\165\057\206\040\222\333\110\225\245"
	"\273\120\136\111\374\302\031\057\327\305\162\114\143\367\247\002"
	"\153\167\110\150\052\070\045\303\267\161\234\204\161\363\107\250"
	"\175\211\030\001\270\144\256\273\066\100\116\077\375\127\306\244"
	"\177\177\240\063\060\304\324\357\160\220\167\067\317\267\162\042"
	"\117\374\105\004\343\226\026\234\206\231\066\207\244\271\200\072"
	"\335\052\306\217\322\175\325\267\103\255\337\075\013\257\015\002"
	"\165\243\132\146\222\314\153\213\026\027\236\002\120\253\023\236"
	"\114\222\014\247\157\174\042\154\107\270\275\225\252\374\312\150"
	"\366\230\172\222\000\022\326\125\162\220\053\307\257\202\050\164"
	"\311\036\077\331\054\272\035\152\372\211\366\267\375\266\137\317"
	"\111\061\023\161\334\067\161\265\062\073\366\313\327\044\245\376"
	"\322\075\051\310\226\175\020\154\075\332\310\355\230\010\260\027"
	"\202\367\076\115\375\371\326\317\136\073\343\332\005\066\173\116"
	"\347\112\032\055\107\252\037\323\032\212\375\116\147\236\140\342"
	"\337\106\005\334\057\251\235\033\062\003\376\373\253\075\126\064"
	"\062\146\070\351\172\241\310\130\176\012\140\172\041\051\150\226"
	"\312\212\257\252\376\366\231\036\062\073\330\100\234\016\014\066"
	"\270\215\127\150\334\133\021\002\210\076\116\020\073\206\150\354"
	"\104\355\137\076\066\070\013\043\147\165\214\372\332\055\003\134"
	"\252\126\226\046\016\010\000\233\142\174\215\320\070\027\275\053"
	"\147\307\074\175\324\024\333\076\266\126\202\372\234\355\241\117"
	"\170\031\344\247\305\074\161\165\021\037\364\027\043\330\043\021"
	"\115\151\041\056\335\247\116\346\121\070\370\201\101\117\143\052"
	"\030\254\327\117\344\242\315\170\302\007\233\225\200\322\044\057"
	"\144\327\356\130\373\114\272\061\244\164\220\341\162\041\141\143"
	"\177\015\011\136\076\174\371\353\302\374\144\153\013\332\204\235"
	"\002\126\335\256\254\074\123\007\241\274\274\213\315\040\350\326"
	"\252\141\025\377\234\316\343\301\115\232\175\055\103\077\355\263"
	"\057\314\077\317\037\143\240\266\111\030\154\074\323\304\005\070"
	"\077\024\324\227\024\005\135\110\366\356\256\070\151\104\200\235"
	"\171\247\340\004\346\247\362\326\036\150\107\247\314\221\114\053"
	"\035\115\312\026\247\355\351\333\231\225\115\111\037\362\331\075"
	"\202\120\220\224\175\061\057\107\225\102\367\173\330\371\032\334"
	"\350\236\300\203\125\150\027\350\032\161\147\066\372\361\206\204"
	"\261\241\263\315\274\067\371\263\316\054\020\255\223\313\222\120"
	"\037\254\157\227\005\040\315\026\204\023\154\364\236\250\364\327"
	"\343\311\116\211\023\331\324\314\074\262\067\014\311\267\362\317"
	"\155\037\052\373\133\225\101\144\242\261\251\234\266\272\312\222"
	"\321\037\210\372\204\043\375\301\326\065\316\240\355\301\157\132"
	"\341\231\125\074\056\227\241\321\110\113\155\376\005\070\221\327"
	"\130\031\321\334\075\317\235\024\005\153\264\362\054\043\115\015"
	"\274\242\112\353\072\353\274\202\066\052\200\074\142\022\023\272"
	"\053\345\227\151\265\064\176\272\240\062\255\314\125\372\332\022"
	"\235\045\375\327\020\271\131\107\343\332\203\106\354\226\000\030"
	"\173\227\202\060\314\000\353\154\062\230\071\210\223\024\232\060"
	"\071\230\007\112\121\140\221\065\073\024\173\047\253\174\100\047"
	"\024\302\130\341\302\103\116\365\334\210\176\157\234\031\237\326"
	"\261\247\040\003\010\262\070\103\307\264\153\162\061\253\232\106"
	"\156\362\047\061\066\165\047\023\376\245\203\232\276\042\161\157"
	"\312\221\162\322\104\253\026\013\140\201\176\221\055\030\330\234"
	"\013\377\315\101\165\364\125\163\231\330\016\130\373\177\310\305"
	"\021\073\230\125\347\256\140\107\060\336\331\136\367\261\372\002"
	"\260\310\104\046\274\231\231\126\162\250\257\155\047\167\063\071"
	"\262\314\216\231\172\357\341\253\316\272\012\306\153\005\310\034"
	"\315\014\102\212\246\334\340\030\205\220\206\255\007\272\346\272"
	"\206\165\124\001\145\065\254\064\360\267\372\133\274\302\170\212"
	"\317\273\024\166\230\365\216\035\205\025\312\215\317\260\110\125"
	"\045\234\126\213\322\003\277\302\272\271\036\167\174\226\001\113"
	"\122\026\301\352\014\120\007\222\145\321\037\065\202\150\212\250"
	"\004\340\063\327\344\362\231\236\254\270\026\051\117\030\164\241"
	"\057\066\213\073\207\222\315\355\144\355\042\346\125\255\217\132"
	"\215\302\061\161\265\313\020\142\203\047\213\323\077\000\164\156"
	"\067\000\252\276\223\167\254\367\145\316\336\272\173\155\025\011"
	"\060\106\173\346\022\214\110\225\263\323\151\362\324\335\141\013"
	"\336\013\312\161\203\166\151\350\105\107\243\301\265\270\313\346"
	"\377\106\314\021\323\024\247\206\350\020\171\274\356\333\310\314"
	"\346\222\075\152\011\247\122\116\356\366\020\244\256\333\212\255"
	"\042\126\277\365\153\146\174\124\166\366\021\144\321\331\061\270"
	"\154\157\042\165\026\165\304\005\153\324\251\032\257\064\310\322"
	"\212\207\307\366\355\104\112\144\072\133\311\013\065\372\303\241"
	"\151\346\027\177\133\333\205\307\257\056\341\137\142\251\061\355"
	"\061\371\344\036\076\056\203\170\212\114\204\300\106\110\142\260"
	"\056\171\060\211\124\265\121\004\344\062\144\106\334\225\064\016"
	"\217\030\055\315\107\260\106\322\374\312\222\102\022\364\362\100"
	"\155\043\312\302\330\033\306\274\116\052\003\053\300\067\071\120"
	"\120\146\036\227\026\144\152\022\057\374\125\101\361\110\202\137"
	"\153\115\041\103\151\350\000\267\023\003\342\323\073\033\044\213"
	"\201\102\043\227\247\215\252\327\212\377\031\173\107\233\332\262"
	"\351\374\366\122\344\366\011\370\372\354\313\065\010\360\301\211"
	"\063\345\041\333\163\313\262\375\313\313\171\022\147\123\305\120"
	"\120\274\243\065\263\254\055\255\231\371\343\241\351\245\053\035"
	"\213\114\370\376\030\252\373\344\166\164\367\335\310\274\056\031"
	"\171\321\116\054\176\173\332\027\164\276\271\136\144\344\173\357"
	"\061\163\355\111\036\351\056\224\136\045\162\047\342\240\100\133"
	"\162\216\210\360\012\142\010\176\041\301\335\205\245\130\164\326"
	"\314\141\040\353\113\116\177\251\164\362\320\126\223\020\261\005"
	"\237\071\365\251\234\376\050\275\277\005\102\144\135\266\073\052"
	"\030\134\025\143\253\225\015\037\207\335\165\033\355\047\040\215"
	"\141\026\066\375\024\136\272\323\143\375\070\301\264\164\353\315"
	"\321\001\061\174\226\076\234\036\033\021\071\011\071\131\226\232"
	"\160\315\227\204\053\122\130\217\120\221\120\004\005\074\321\326"
	"\075\002\123\323\100\357\361\134\001\053\146\072\204\374\325\365"
	"\311\155\171\365\277\322\204\017\143\325\024\151\022\345\100\117"
	"\350\223\043\050\203\025\205\204\100\353\277\305\347\224\272\261"
	"\002\064\247\301\006\054\321\151\001\346\323\024\313\023\143\263"
	"\247\207\334\052\235\141\256\335\114\156\243\064\003\135\346\005"
	"\221\215\307\230\272\230\002\274\177\325\320\112\351\064\376\220"
	"\273\332\272\130\074"
#define      chk1_z	22
#define      chk1	((&data[6787]))
	"\327\175\212\107\304\226\133\051\070\114\307\276\222\002\167\017"
	"\114\053\314\374\304\262\016\331\274\332"
#define      msg2_z	19
#define      msg2	((&data[6815]))
	"\311\061\246\316\371\276\252\044\300\235\111\327\100\351\324\051"
	"\177\047\067\070\163\154\141\353\077\144"
#define      chk2_z	19
#define      chk2	((&data[6841]))
	"\170\011\043\021\055\062\253\247\250\141\063\220\207\134\271\322"
	"\203\230\341\254\032\137\254"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */
#define MMAP2		0	/* Define as 1 to use syscall mmap2 */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
#if MMAP2
    Allow(mmap2),       /* also for malloc() */
#else
    Allow(mmap),        /* also for malloc() */
#endif
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
